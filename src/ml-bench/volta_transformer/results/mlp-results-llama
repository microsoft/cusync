1 & 8192 & pytorch & 191.17
1 & 8192 & streamk & 215.04 & 215.07 & 186.85 & 616.96
1 & 8192 & baseline & 213.28 & 0.96 & 133.56 & 9.94
1 & 8192 & rowsync & 213.28 & 0.96 & 133.56 & 9.94 & 193.17 & 0.79 & 9.43
1 & 8192 & tilesync & 213.28 & 0.96 & 133.56 & 9.94 & 202.44 & 3.79 & 5.08
2 & 8192 & pytorch & 252.02
2 & 8192 & streamk & 215.09 & 215.09 & 187.11 & 617.29
2 & 8192 & baseline & 213.67 & 1.28 & 133.89 & 10.11
2 & 8192 & rowsync & 213.67 & 1.28 & 133.89 & 10.11 & 194.33 & 2.14 & 9.05
2 & 8192 & tilesync & 213.67 & 1.28 & 133.89 & 10.11 & 200.94 & 3.15 & 5.95
4 & 8192 & pytorch & 253.47
4 & 8192 & streamk & 215.14 & 215.19 & 186.96 & 617.28
4 & 8192 & baseline & 214.39 & 1.04 & 133.94 & 10.39
4 & 8192 & rowsync & 214.39 & 1.04 & 133.94 & 10.39 & 194.28 & 1.36 & 9.38
4 & 8192 & tilesync & 214.39 & 1.04 & 133.94 & 10.39 & 201.61 & 1.88 & 5.96
8 & 8192 & pytorch & 256.45
8 & 8192 & streamk & 215.29 & 215.13 & 186.84 & 617.26
8 & 8192 & baseline & 214.39 & 1.50 & 134.11 & 10.11
8 & 8192 & rowsync & 214.39 & 1.50 & 134.11 & 10.11 & 198.00 & 2.43 & 7.64
8 & 8192 & tilesync & 214.39 & 1.50 & 134.11 & 10.11 & 201.50 & 1.58 & 6.01
16 & 8192 & pytorch & 262.88
16 & 8192 & streamk & 215.28 & 215.39 & 186.70 & 617.37
16 & 8192 & baseline & 215.61 & 0.78 & 134.39 & 10.39
16 & 8192 & rowsync & 215.61 & 0.78 & 134.39 & 10.39 & 200.78 & 2.05 & 6.88
16 & 8192 & tilesync & 215.61 & 0.78 & 134.39 & 10.39 & 202.39 & 1.14 & 6.13
32 & 8192 & pytorch & 225.47
32 & 8192 & streamk & 215.22 & 215.43 & 186.87 & 617.52
32 & 8192 & baseline & 217.50 & 1.10 & 135.22 & 10.22
32 & 8192 & rowsync & 217.50 & 1.10 & 135.22 & 10.22 & 215.22 & 1.86 & 1.05
32 & 8192 & tilesync & 217.50 & 1.10 & 135.22 & 10.22 & 205.83 & 1.89 & 5.36
64 & 8192 & pytorch & 251.46
64 & 8192 & streamk & 215.03 & 215.02 & 185.22 & 615.27
64 & 8192 & baseline & 238.39 & 1.79 & 144.39 & 10.50
64 & 8192 & rowsync & 238.39 & 1.79 & 144.39 & 10.50 & 237.67 & 1.03 & 0.30
64 & 8192 & tilesync & 238.39 & 1.79 & 144.39 & 10.50 & 221.83 & 1.54 & 6.94
128 & 8192 & pytorch & 336.78
128 & 8192 & streamk & 216.26 & 216.35 & 186.11 & 618.73
128 & 8192 & baseline & 290.61 & 3.11 & 174.61 & 10.78
128 & 8192 & rowsync & 290.61 & 3.11 & 174.61 & 10.78 & 258.72 & 2.27 & 10.97
128 & 8192 & tilesync & 290.61 & 3.11 & 174.61 & 10.78 & 269.94 & 2.62 & 7.11
256 & 8192 & pytorch & 521.05
256 & 8192 & streamk & 228.76 & 228.85 & 157.38 & 614.98
256 & 8192 & baseline & 437.22 & 2.21 & 260.56 & 15.61
256 & 8192 & rowsync & 437.22 & 2.21 & 260.56 & 15.61 & 420.83 & 2.55 & -7.69
256 & 8192 & tilesync & 437.22 & 2.21 & 260.56 & 15.61 & 400.94 & 3.46 & 8.30
512 & 8192 & pytorch & 975.73
512 & 8192 & streamk & 427.37 & 427.12 & 411.21 & 1265.70
512 & 8192 & baseline & 738.67 & 16.60 & 460.61 & 24.94
512 & 8192 & rowsync & 738.67 & 16.60 & 460.61 & 24.94 & 732.78 & 6.32 & 0.80
512 & 8192 & tilesync & 738.67 & 16.60 & 460.61 & 24.94 & 683.61 & 4.83 & 7.45
1024 & 8192 & pytorch & 2041.56
1024 & 8192 & streamk & 729.84 & 727.11 & 723.66 & 2180.61
1024 & 8192 & baseline & 1343.67 & 10.43 & 832.89 & 34.56
1024 & 8192 & rowsync & 1343.67 & 10.43 & 832.89 & 34.56 & 1390.83 & 45.67 & -3.51
1024 & 8192 & tilesync & 1343.67 & 10.43 & 832.89 & 34.56 & 1182.39 & 5.54 & 12.00
2048 & 8192 & pytorch & 3460.41
2048 & 8192 & streamk & 1387.96 & 1388.00 & 1345.78 & 4121.74
2048 & 8192 & baseline & 2479.22 & 5.36 & 1521.33 & 58.78
2048 & 8192 & rowsync & 2479.22 & 5.36 & 1521.33 & 58.78 & 2276.39 & 29.47 & 8.18
2048 & 8192 & tilesync & 2479.22 & 5.36 & 1521.33 & 58.78 & 2279.00 & 24.55 & 8.08


On V100 SMX-2
1 & 8192 & baseline & 210.06 & 1.00 & 126.56 & 12.61
1 & 8192 & rowsync & 210.06 & 1.00 & 126.56 & 12.61 & 185.56 & 2.09 & 11.66
1 & 8192 & tilesync & 210.06 & 1.00 & 126.56 & 12.61 & 191.00 & 2.40 & 9.07
2 & 8192 & baseline & 211.22 & 1.35 & 127.17 & 12.50
2 & 8192 & rowsync & 211.22 & 1.35 & 127.17 & 12.50 & 193.61 & 2.48 & 8.34
2 & 8192 & tilesync & 211.22 & 1.35 & 127.17 & 12.50 & 191.72 & 2.65 & 9.23
4 & 8192 & baseline & 211.83 & 1.10 & 127.56 & 12.78
4 & 8192 & rowsync & 211.83 & 1.10 & 127.56 & 12.78 & 195.17 & 2.18 & 7.87
4 & 8192 & tilesync & 211.83 & 1.10 & 127.56 & 12.78 & 192.89 & 3.03 & 8.94
8 & 8192 & baseline & 211.94 & 0.54 & 127.78 & 12.50
8 & 8192 & rowsync & 211.94 & 0.54 & 127.78 & 12.50 & 196.61 & 3.94 & 7.23
8 & 8192 & tilesync & 211.94 & 0.54 & 127.78 & 12.50 & 193.28 & 2.47 & 8.81
16 & 8192 & baseline & 212.67 & 1.28 & 127.72 & 12.33
16 & 8192 & rowsync & 212.67 & 1.28 & 127.72 & 12.33 & 199.56 & 3.22 & 6.17
16 & 8192 & tilesync & 212.67 & 1.28 & 127.72 & 12.33 & 194.67 & 1.41 & 8.46
32 & 8192 & baseline & 217.44 & 1.34 & 129.67 & 12.83
32 & 8192 & rowsync & 217.44 & 1.34 & 129.67 & 12.83 & 230.11 & 3.32 & -5.83
32 & 8192 & tilesync & 217.44 & 1.34 & 129.67 & 12.83 & 206.94 & 1.55 & 4.83
64 & 8192 & baseline & 234.28 & 1.56 & 139.17 & 12.61
64 & 8192 & rowsync & 234.28 & 1.56 & 139.17 & 12.61 & 253.44 & 1.54 & -8.18
64 & 8192 & tilesync & 234.28 & 1.56 & 139.17 & 12.61 & 230.44 & 1.69 & 1.64
128 & 8192 & baseline & 284.94 & 2.26 & 168.17 & 12.67
128 & 8192 & rowsync & 284.94 & 2.26 & 168.17 & 12.67 & 276.00 & 1.68 & 3.14
128 & 8192 & tilesync & 284.94 & 2.26 & 168.17 & 12.67 & 267.00 & 1.71 & 6.30
256 & 8192 & baseline & 427.89 & 2.19 & 252.94 & 16.94
256 & 8192 & rowsync & 427.89 & 2.19 & 252.94 & 16.94 & 502.06 & 1.89 & -17.33
256 & 8192 & tilesync & 427.89 & 2.19 & 252.94 & 16.94 & 389.17 & 1.54 & 9.05
512 & 8192 & baseline & 732.83 & 14.26 & 462.00 & 29.61
512 & 8192 & rowsync & 732.83 & 14.26 & 462.00 & 29.61 & 743.50 & 3.99 & -1.46
512 & 8192 & tilesync & 732.83 & 14.26 & 462.00 & 29.61 & 620.00 & 2.57 & 15.40
1024 & 8192 & baseline & 1164.00 & 9.44 & 708.28 & 37.78
1024 & 8192 & rowsync & 1164.00 & 9.44 & 708.28 & 37.78 & 1351.11 & 8.04 & -16.07
1024 & 8192 & tilesync & 1164.00 & 9.44 & 708.28 & 37.78 & 1023.06 & 2.88 & 12.11
2048 & 8192 & baseline & 2093.33 & 4.10 & 1273.50 & 63.78
2048 & 8192 & rowsync & 2093.33 & 4.10 & 1273.50 & 63.78 & 2232.56 & 8.03 & -6.65
2048 & 8192 & tilesync & 2093.33 & 4.10 & 1273.50 & 63.78 & 2266.67 & 6.98 & -8.28

One V100-SMX2 with fused SwiGLU and fix TileOrder
1 & 8192 & baseline & 197.33 & 1.75 & 125.39 & 0.00
1 & 8192 & rowsync & 197.33 & 1.75 & 125.39 & 0.00 & 186.17 & 1.10 & 5.66
1 & 8192 & tilesync & 197.33 & 1.75 & 125.39 & 0.00 & 175.89 & 0.96 & 10.87
2 & 8192 & baseline & 193.83 & 1.10 & 123.50 & 0.06
2 & 8192 & rowsync & 193.83 & 1.10 & 123.50 & 0.06 & 187.11 & 1.32 & 3.47
2 & 8192 & tilesync & 193.83 & 1.10 & 123.50 & 0.06 & 176.61 & 1.04 & 8.89
4 & 8192 & baseline & 194.28 & 0.83 & 124.06 & 0.06
4 & 8192 & rowsync & 194.28 & 0.83 & 124.06 & 0.06 & 188.22 & 1.11 & 3.12
4 & 8192 & tilesync & 194.28 & 0.83 & 124.06 & 0.06 & 176.83 & 0.92 & 8.98
8 & 8192 & baseline & 195.39 & 1.46 & 124.22 & 0.00
8 & 8192 & rowsync & 195.39 & 1.46 & 124.22 & 0.00 & 188.94 & 1.16 & 3.30
8 & 8192 & tilesync & 195.39 & 1.46 & 124.22 & 0.00 & 178.22 & 0.81 & 8.79
16 & 8192 & baseline & 196.72 & 1.07 & 125.11 & 0.11
16 & 8192 & rowsync & 196.72 & 1.07 & 125.11 & 0.11 & 192.67 & 1.24 & 2.06
16 & 8192 & tilesync & 196.72 & 1.07 & 125.11 & 0.11 & 181.56 & 0.98 & 7.71
32 & 8192 & baseline & 203.56 & 1.95 & 129.89 & 0.00
32 & 8192 & rowsync & 203.56 & 1.95 & 129.89 & 0.00 & 199.22 & 1.40 & 2.13
32 & 8192 & tilesync & 203.56 & 1.95 & 129.89 & 0.00 & 187.00 & 1.33 & 8.13
64 & 8192 & baseline & 227.39 & 1.38 & 139.67 & 0.06
64 & 8192 & rowsync & 227.39 & 1.38 & 139.67 & 0.06 & 220.44 & 1.42 & 3.05
64 & 8192 & tilesync & 227.39 & 1.38 & 139.67 & 0.06 & 213.22 & 1.56 & 6.23
128 & 8192 & baseline & 286.06 & 1.63 & 185.00 & 0.00
128 & 8192 & rowsync & 286.06 & 1.63 & 185.00 & 0.00 & 325.33 & 1.71 & -13.73
128 & 8192 & tilesync & 286.06 & 1.63 & 185.00 & 0.00 & 251.17 & 1.69 & 12.20
256 & 8192 & baseline & 412.56 & 1.98 & 253.72 & 0.00
256 & 8192 & rowsync & 412.56 & 1.98 & 253.72 & 0.00 & 433.61 & 2.25 & -5.10
256 & 8192 & tilesync & 412.56 & 1.98 & 253.72 & 0.00 & 351.89 & 3.39 & 14.71
512 & 8192 & baseline & 543.72 & 1.60 & 367.44 & 0.00
512 & 8192 & rowsync & 543.72 & 1.60 & 367.44 & 0.00 & 674.44 & 1.76 & -24.04
512 & 8192 & tilesync & 543.72 & 1.60 & 367.44 & 0.00 & 510.72 & 1.56 & 6.07
1024 & 8192 & baseline & 1018.06 & 1.80 & 691.22 & 0.00
1024 & 8192 & rowsync & 1018.06 & 1.80 & 691.22 & 0.00 & 823.33 & 2.59 & 19.13
1024 & 8192 & tilesync & 1018.06 & 1.80 & 691.22 & 0.00 & 758.50 & 1.95 & 25.50
2048 & 8192 & baseline & 1657.50 & 2.94 & 1061.72 & 0.00
2048 & 8192 & rowsync & 1657.50 & 2.94 & 1061.72 & 0.00 & 1440.06 & 12.05 & 13.12
2048 & 8192 & tilesync & 1657.50 & 2.94 & 1061.72 & 0.00 & 1461.50 & 5.25 & 11.83

Fixing TileSync

1 & 8192 & baseline & 189.94 & 1.47 & 122.00 & 0.00
1 & 8192 & rowsync & 189.94 & 1.47 & 122.00 & 0.00 & 183.17 & 1.25 & 3.57
1 & 8192 & tilesync & 189.94 & 1.47 & 122.00 & 0.00 & 176.11 & 1.02 & 7.28
2 & 8192 & baseline & 189.78 & 1.31 & 121.56 & 0.00
2 & 8192 & rowsync & 189.78 & 1.31 & 121.56 & 0.00 & 183.56 & 0.86 & 3.28
2 & 8192 & tilesync & 189.78 & 1.31 & 121.56 & 0.00 & 179.50 & 1.20 & 5.42
4 & 8192 & baseline & 193.89 & 1.37 & 123.61 & 0.00
4 & 8192 & rowsync & 193.89 & 1.37 & 123.61 & 0.00 & 188.06 & 1.21 & 3.01
4 & 8192 & tilesync & 193.89 & 1.37 & 123.61 & 0.00 & 179.67 & 1.19 & 7.34
8 & 8192 & baseline & 195.50 & 1.42 & 124.50 & 0.06
8 & 8192 & rowsync & 195.50 & 1.42 & 124.50 & 0.06 & 189.44 & 0.92 & 3.10
8 & 8192 & tilesync & 195.50 & 1.42 & 124.50 & 0.06 & 181.00 & 1.24 & 7.42
16 & 8192 & baseline & 197.22 & 1.22 & 125.33 & 0.06
16 & 8192 & rowsync & 197.22 & 1.22 & 125.33 & 0.06 & 192.33 & 1.14 & 2.48
16 & 8192 & tilesync & 197.22 & 1.22 & 125.33 & 0.06 & 183.28 & 1.84 & 7.07
32 & 8192 & baseline & 202.83 & 1.29 & 129.50 & 0.00
32 & 8192 & rowsync & 202.83 & 1.29 & 129.50 & 0.00 & 198.50 & 1.50 & 2.14
32 & 8192 & tilesync & 202.83 & 1.29 & 129.50 & 0.00 & 189.17 & 1.25 & 6.74
64 & 8192 & baseline & 227.17 & 1.95 & 139.44 & 0.06
64 & 8192 & rowsync & 227.17 & 1.95 & 139.44 & 0.06 & 220.67 & 1.53 & 2.86
64 & 8192 & tilesync & 227.17 & 1.95 & 139.44 & 0.06 & 216.06 & 2.39 & 4.89
128 & 8192 & baseline & 285.94 & 1.26 & 184.89 & 0.00
128 & 8192 & rowsync & 285.94 & 1.26 & 184.89 & 0.00 & 324.83 & 1.15 & -13.60
128 & 8192 & tilesync & 285.94 & 1.26 & 184.89 & 0.00 & 250.94 & 1.73 & 12.24
256 & 8192 & baseline & 413.06 & 1.98 & 253.67 & 0.06
256 & 8192 & rowsync & 413.06 & 1.98 & 253.67 & 0.06 & 432.33 & 1.75 & -4.67
256 & 8192 & tilesync & 413.06 & 1.98 & 253.67 & 0.06 & 355.50 & 3.00 & 13.93
512 & 8192 & baseline & 545.06 & 1.66 & 368.33 & 0.00
512 & 8192 & rowsync & 545.06 & 1.66 & 368.33 & 0.00 & 674.22 & 2.65 & -23.70
512 & 8192 & tilesync & 545.06 & 1.66 & 368.33 & 0.00 & 463.83 & 2.43 & 14.90
1024 & 8192 & baseline & 965.67 & 1.08 & 655.61 & 0.00
1024 & 8192 & rowsync & 965.67 & 1.08 & 655.61 & 0.00 & 823.00 & 2.85 & 14.77
1024 & 8192 & tilesync & 965.67 & 1.08 & 655.61 & 0.00 & 757.89 & 1.53 & 21.52
2048 & 8192 & baseline & 1872.78 & 13.63 & 1196.11 & 0.06
2048 & 8192 & rowsync & 1872.78 & 13.63 & 1196.11 & 0.06 & 1489.50 & 6.90 & 20.47
2048 & 8192 & tilesync & 1872.78 & 13.63 & 1196.11 & 0.06 & 1464.72 & 4.73 & 21.79